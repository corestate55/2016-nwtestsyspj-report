%% -*- coding: utf-8-unix -*-

\chapter{はじめに}
\label{chap:abstract}

本書は、沖縄オープンラボラトリ~\cite{ool-web}で2016年度に実施された「ネッ
トワークテストシステムプロジェクト」の成果報告書である。本書の目的は、プ
ロジェクトの目標と実施した活動、活動の結果・成果をまとめ、報告することで
ある。特に、最終的な成果(物)についての解説だけでなく、そこへ至るまでの検
討過程・判断や選択の基準などについても取りあげ、「考えかた」についても共
有することを目的としている。

 \section{本プロジェクトの目的}
 \label{sec:pj-purpose}

% TODO: OOD発表資料のp1 : 視点/観点の話をいれること
% OOD発表資料のp.2-3

情報システムを構築して利用者に提供していくにあたって、システムを構築・運
用する側は、様々な製品や技術を組み合わせてシステムを構成し、サービスを実
現していく必要がある。複数の仮想化技術を導入し、拡張性に対する要求とそれ
を実現するための自動化技術が発展したことにより、システムは抽象化されて、
より柔軟な制御が可能になった。その反面、大規模かつ複雑にもなっている。こ
うした、ブラックボックスを多数くみあわせた複雑なシステムの構築や運用では、
構成要素どうしの連携を把握し、システム内部変更によるシステム全体の動作や
サービスへの影響を判断することは難しい。一方で、利用者の要求やサービスが
変化するサイクルは速くなっており、システム開発者やサービス提供者は、その
要求に追従していくことが求められる。

今後サービス提供者は、システムに加えた機能や変化によって最終的に利用者に
対して価値が提供できているかどうか、サービス利用者の観点でシステムの状況
を判断することがより重要になっていく。本プロジェクトは、サービス変化の迅
速性を考えるうえでボトルネックになりがちなネットワークに着目する。より高
速かつ網羅的にネットワークが提供するサービスの正常性を確認する(テストす
る)ためのシステム = ネットワークテストシステムの提案、およびその有効性を
確認するための実証実験をおこなう。これによって従来のネットワーク構築・運
用における迅速性の向上、リスク低減をおこない、CI/CDプロセスを実現させる
ことを目指す。

 \section{関連研究}
 \label{sec:related-research}

  \subsection{沖縄オープンラボラトリ}

沖縄オープンラボラトリでは、本プロジェクト以外にネットワークテストに関す
る研究が複数ある。OF-Patchプロジェクト~\cite{ool-testbedpj}はOpenFlow制
御による物理パッチパネルを実装・OSS公開している。また、それによって実際
に沖縄オープンラボのテストベッドを構築し、利用者に提供している。VNFテス
トシナリオ自動化PJ~\cite{ool-vnftestpj}はVNFのデプロイパターンや相互接続
性に着目している。このプロジェクトでは、ハイパーバイザとVNF・VNF同士の接
続などさまざまなパターンで接続性や性能測定を網羅的に自動実行するシステム
を構築した。OF-PatchはL1(物理トポロジ)操作に、VNFテストシナリオ自動化は
VNFの利用(組合せ・機能・特性)に焦点をあてている。

  \subsection{ネットワークテストの自動化に関する研究・プロダクト}
End-to-endの通信やネットワーク全体のふるまい、物理ネットワークのテストに
着目したテストや検証の自動化に関する関連研究やプロダクト、それらの特徴に
ついて順に挙げる。

    \paragraph{研究}
ホワイトボックススイッチと従来の(レガシーな)ネットワーク機器で構成された
テストベッドネットワークに対して、OSSを組み合わせて任意の箇所に自動で障
害を発生させる検証自動化システム~\cite{wbsw-oss-test-automation}が提案さ
れている。レガシー機器の利用・end-to-endでのふるまいへの着目など本研究と
課題感が近く、テスト環境の自動構築などテストとして求められる機能一式に対
応している。本研究ではテスト対象環境の自動構築には比重を置いていないこと、
テストトラフィックのディストリビューションにOpenFlow制御を利用しているこ
と、テストシナリオ実装の考えかたなどに違いがある。

    \paragraph{商用製品}
FWパケットフィルタをテストする自動化製品として
NeedleWork~\cite{needlework-web}がある。NeedleWorkは小型のアプライアンス
として実装されており、FW単体あるいはFWに接続された3ゾーン(セグメント)構
成のネットワークをテスト対象としている。また、内部ではnetcatを使用してお
り~\cite{needlework-slide}、L4レベルのテストトラフィック生成をおこなうこ
とができる。

    \paragraph{OSS}
ネットワークのテストが可能なOSSとして、
InfraTester~\cite{infratester-github}、ToDD~\cite{todd-github}、
OpenVNet~\cite{openvnet-web}がある。InfraTesterはネットワークを経由して、
サービスの外側からの動作(ふるまい)をテストできる。構成として、定点
(InfraTesterサーバ)から見たときのサービスを観測するかたちになるため、
L2/L3のネットワーク(物理的な分散性)についてはターゲットとしていない。
ToDDは、テスト対象ネットワークにAgentを配布し、ToDDサーバとメッセージキュー
によって情報交換をおこなう~\cite{todd-blog}。テスト自体はtestletという形
でToDDサーバからAgentへおくられ、実行される。Agentを使うことで、ネットワー
クの物理的な分散性(distribution)に対応しており、拡張性のたかいアーキテク
チャをもっている。OpenVNetはOpenFlowを利用したネットワーク仮想化システム
だが、本プロジェクトと同様の課題感から物理ネットワークのテストへの対応を
すすめている。OpenVNetで構成した仮想ネットワーク(オーバーレイ)に対して
OpenFlow対応ハードウェアを介して物理ネットワーク(ネットワーク機器)を接続
する~\cite{openvnet-slide,network-testing-sdn-atmarkit}。仮想ネットワーク
(論理構成)についてはterraformやcloudifyなどのオーケストレーションツール
を併用し、論理構成を記述し、再現・再構成可能とすることで環境構成の自由度
を確保している。

本PoCではターゲットとしていない(\ref{sec:discuss-network-test}節参照)が、
テスト対象となるネットワーク機器の操作をおこなうための仕組みに関する近年
の動向について簡単に触れておく。従来のネットワーク機器API(CLI)を抽象化す
るためのOSS開発~\cite{netmiko-github,trigger-github,napalm-github}は活発
におこなわれている\footnote{本研究では相当する機能について、よりシンプル
で簡易的なツールを使用している(\ref{sec:expectacle}節参照)。}。また、
Ansible~\cite{ansible-web}はバージョン2.2よりネットワーク機器の操作に対
応~\cite{ansible-22-news}しており、ネットワークの構築・運用自動化への応用
事例が増えていくことが予想される。技術動向としては、Google等のネットワー
クオペレータによってベンダ中立なネットワーク機器インタフェース(API)策定
の活動がおこなわれている(OpenConfig~\cite{openconfig})。OpenConfigについ
てはJuniper, Cisco, Aristaなどの商用製品による採用~\cite{openconfig-news}
もはじまっている。

 \section{前提事項}
 \label{sec:premise}

本書の読者としては、ネットワークテストシステムを利用・導入し、有効性の判
断をおこないたいエンジニアを想定している。本書では、以下にあげる点につい
ては基礎知識として取り上げない。

\begin{itemize}
 \item Linuxの基本的な使用方法
       \begin{itemize}
        \item KVM による仮想マシン(VM)の操作/管理
        \item 必要なツールやソフトウェアのインストール/パッケージ管理
        \item Git の使用方法
        \item Linux Network Namespace および iproute2 ( \code{ip} コマン
              ド)によるNamespace の操作
       \end{itemize}
 \item 基本的なネットワークに関する知識
       \begin{itemize}
        \item TCP/IP および Ethernet/VLAN
        \item Cisco や Juniper の L2/L3 Switch, Firewall の基本的な動作・
              設定
       \end{itemize}
 \item OpenFlow
       \begin{itemize}
        \item OpenFlow/1.0
        \item Trema による OpenFlow Controller の実装
        \item OpenFlow スイッチ (Open vSwitch) の基本的な動作・設定
       \end{itemize}
 \item Rubyプログラミング
       \begin{itemize}
        \item RubyEnv をつかった ruby 環境の管理
        \item Bundler をつかったパッケージ管理
        \item Cucumber によるテストシナリオ実装
       \end{itemize}
\end{itemize}

また、本プロジェクトの前身となる、2015年度にOOLで実行したプロジェクト
(「L1patch 応用ネットワークテストシステム」プロジェク
ト~\cite{ool-l1pj-web}、通称\lopj)で扱った内容については解説しない。
\lopj については、\lopjpoc や \lopjtech を参照すること。

%%% Local Variables:
%%% mode: yatex
%%% TeX-master: "main.tex"
%%% End:
